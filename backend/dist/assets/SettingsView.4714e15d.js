var a=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(e,t,r)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,n=(a,e)=>{for(var t in e||(e={}))s.call(e,t)&&o(a,t,e[t]);if(r)for(var t of r(e))l.call(e,t)&&o(a,t,e[t]);return a};import{r as u,e as i,s as d}from"./index.e4d88a3f.js";import{d as p,o as c,c as m,f,t as v,y as w,q as g,s as h,r as _,b as y,h as b,w as N,B as P,g as j}from"./vendor.c4bbfea9.js";import{f as x,v as k}from"./validators.53b6d36c.js";const I={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},z=f("path",{d:"M27.307 6.107L30 3.414L28.586 2l-2.693 2.693L24.8 3.6a1.933 1.933 0 0 0-2.8 0l-18 18V28h6.4l18-18a1.933 1.933 0 0 0 0-2.8zM9.6 26H6v-3.6L23.4 5L27 8.6z",fill:"currentColor"},null,-1),L=f("path",{d:"M9 11.586L16.586 4L18 5.414L10.414 13z",fill:"currentColor"},null,-1);var U=p({name:"Pen",render:function(a,e){return c(),m("svg",I,[z,L])}});const O={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},C=f("path",{d:"M16 8a5 5 0 1 0 5 5a5 5 0 0 0-5-5zm0 8a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3z",fill:"currentColor"},null,-1),A=f("path",{d:"M16 2a14 14 0 1 0 14 14A14.016 14.016 0 0 0 16 2zm-6 24.377V25a3.003 3.003 0 0 1 3-3h6a3.003 3.003 0 0 1 3 3v1.377a11.899 11.899 0 0 1-12 0zm13.992-1.451A5.002 5.002 0 0 0 19 20h-6a5.002 5.002 0 0 0-4.992 4.926a12 12 0 1 1 15.985 0z",fill:"currentColor"},null,-1);var E=p({name:"UserAvatar",render:function(a,e){return c(),m("svg",O,[C,A])}});const M={key:0,class:"spin_wrapper"},S=j(" Logout "),B={class:"icon_wrapper"},R=["src"],D=j("Upload Avatar"),$=j(" Submit changes ");var F=p({setup(a){const r=v({username:"",firstName:"",lastName:"",avatarImage:"",password:""}),s=v({username:"",firstName:"",lastName:"",avatarImage:"",password:"",rePassword:""}),l=w(),o=g(),p=h(),j=(I=n({},x),z={rePassword:{trigger:"input",validator:k(s)}},e(I,t(z)));var I,z;u.get(i.userInfo).then((a=>{if(a.data.user&&a.data.username){const{last_name:e,first_name:t,id:s,avatar_image:l}=a.data.user;r.firstName=t,r.lastName=e,r.username=a.data.username,r.avatarImage=l}})).catch((a=>{console.log(a)}));const L=async()=>{try{(await u.post(i.logout,{},{headers:n({},d())})).data.success&&(localStorage.clear(),o.replace("/auth"),l.commit("clearStore"))}catch(a){console.error(a)}},O=async({file:a})=>{if("image/png"===a.file.type||"image/jpeg"===a.file.type||"image/jpg"===a.file.type){const e=new FileReader;return e.onload=a=>{var e,t;r.avatarImage=null==(e=a.target)?void 0:e.result,s.avatarImage=null==(t=a.target)?void 0:t.result},e.readAsDataURL(a.file),!0}return!1},C=async a=>{var e;a.preventDefault(),null==(e=p.value)||e.validate((async a=>{if(a)return!1;try{const a=Object.assign({},s);for(let e in a)"username"===e&&a[e].trim()&&localStorage.setItem("username",a[e]),a[e].trim()&&"rePassword"!==e||delete a[e];if((await u.put(i.updateAccount,a,{headers:n({},d())})).data.succes){for(let e in a)r[e]=a[e],s[e]="";s.rePassword&&(s.rePassword="")}}catch(e){console.error(e)}}))};return(a,e)=>{const t=_("n-spin"),l=_("n-button"),o=_("n-icon"),n=_("n-upload"),u=_("n-form-item"),i=_("n-input"),d=_("n-collapse-item"),v=_("n-collapse"),w=_("n-form"),g=_("n-space");return y(r).username?(c(),m(g,{key:1,justify:"center"},{default:N((()=>[f(g,{vertical:""},{default:N((()=>[f(l,{class:"logout_btn",block:"",type:"error",onClick:L},{default:N((()=>[S])),_:1}),P("div",B,[y(r).avatarImage?(c(),b("img",{key:1,src:y(r).avatarImage,alt:"User avatar",class:"avatar_image"},null,8,R)):(c(),m(o,{key:0,size:"200"},{default:N((()=>[f(y(E))])),_:1}))]),f(w,{ref:(a,e)=>{e.formRef=a,p.value=a},model:y(s),class:"user_info",rules:j},{default:N((()=>[f(u,{path:"avatarImage",class:"upload_btn_wrapper"},{default:N((()=>[f(n,{onBeforeUpload:O,onRemove:e[0]||(e[0]=()=>y(s).avatarImage="")},{default:N((()=>[f(l,null,{default:N((()=>[D])),_:1})])),_:1})])),_:1}),f(v,{class:"collapse_wrapper"},{"header-extra":N((()=>[f(o,{size:"17"},{default:N((()=>[f(y(U))])),_:1})])),default:N((()=>[f(d,{title:`Username: ${y(r).username}`,class:"collapse_item"},{default:N((()=>[f(u,{path:"username"},{default:N((()=>[f(i,{placeholder:"Enter username",value:y(s).username,"onUpdate:value":e[1]||(e[1]=a=>y(s).username=a)},null,8,["value"])])),_:1})])),_:1},8,["title"]),f(d,{title:`First name: ${y(r).firstName}`,class:"collapse_item"},{default:N((()=>[f(u,{path:"firstName"},{default:N((()=>[f(i,{placeholder:"Enter first name",value:y(s).firstName,"onUpdate:value":e[2]||(e[2]=a=>y(s).firstName=a)},null,8,["value"])])),_:1})])),_:1},8,["title"]),f(d,{title:`Last name: ${y(r).lastName}`,class:"collapse_item"},{default:N((()=>[f(u,{path:"lastName"},{default:N((()=>[f(i,{placeholder:"Enter last name",value:y(s).lastName,"onUpdate:value":e[3]||(e[3]=a=>y(s).lastName=a)},null,8,["value"])])),_:1})])),_:1},8,["title"]),f(d,{title:"Change password",class:"collapse_item"},{default:N((()=>[f(u,{path:"password"},{default:N((()=>[f(i,{type:"password",placeholder:"Enter new password",value:y(s).password,"onUpdate:value":e[4]||(e[4]=a=>y(s).password=a),"show-password-on":"mousedown"},null,8,["value"])])),_:1}),f(u,{path:"rePassword"},{default:N((()=>[f(i,{type:"password",placeholder:"Enter re-password",value:y(s).rePassword,"onUpdate:value":e[5]||(e[5]=a=>y(s).rePassword=a),"show-password-on":"mousedown"},null,8,["value"])])),_:1})])),_:1})])),_:1}),f(l,{class:"submit_btn",type:"primary",onClick:C,block:""},{default:N((()=>[$])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})):(c(),b("div",M,[f(t,{size:"large"})]))}}});export{F as default};
